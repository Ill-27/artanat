<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Защитные заголовки -->
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'self';
        script-src 'self' https://cdn.jsdelivr.net 'unsafe-eval';
        style-src 'self' https://fonts.googleapis.com 'unsafe-inline';
        font-src 'self' https://fonts.gstatic.com;
        img-src 'self' data:;
        connect-src 'self';
        frame-ancestors 'none';
    ">
    <meta http-equiv="X-Frame-Options" content="deny">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>AT-Infinity | Circular Glowing Logo</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fira+Code&display=swap');
        
        body { 
            margin: 0; 
            overflow: hidden; 
            background: transparent; 
            cursor: none;
            touch-action: manipulation;
        }
        #logo-container {
            position: fixed;
            top: 0px;
            left: 0px;
            width: 120px;
            height: 120px;
            z-index: 1000;
        }
        #cursor-container {
            position: fixed;
            width: 70px;
            height: 70px;
            pointer-events: none;
            z-index: 1001;
            transform: translate(-50%, -50%);
            display: none;
        }
        #white-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: white;
            z-index: 9999;
            display: none;
        }
        canvas { 
            display: block; 
            width: 100%;
            height: 100%;
        }

        /* Стили для копирайта ARTERRII */
        #arterii-license {
            position: fixed; 
            bottom: 20px; 
            left: 20px; 
            font-family: 'Fira Code', monospace; 
            color: white;
            text-align: left; 
            z-index: 1002; 
            font-size: 13px;
            opacity: 1;
            animation: fadeIn 1s ease-out forwards;
            line-height: 1.9;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        /* Стили для кнопки полноэкранного режима */
        .fullscreen-btn {
            position: fixed;
            bottom: 20px;
            right: 20px;
            cursor: pointer;
            font-size: 14px;
            padding: 3px 8px;
            border: 1px solid white;
            border-radius: 0px;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            z-index: 1002;
        }
        .fullscreen-btn:hover {
            background: rgba(255,255,255,0.2);
            box-shadow: 0 0 8px rgba(255,255,255,0.5);
        }

        /* Стили для кнопки Telegram */
        .telegram-btn {
            position: fixed;
            bottom: 60px;
            right: 20px;
            cursor: pointer;
            font-size: 14px;
            padding: 3px 8px;
            border: 1px solid white;
            border-radius: 0px;
            transition: all 0.3s ease;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            width: 24px;
            height: 24px;
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='white'%3E%3Cpath d='M9.78 18.65l.28-4.23 7.68-6.92c.34-.31-.07-.46-.52-.19L7.74 13.3 3.64 12c-.88-.25-.89-.86.2-1.3l15.97-6.16c.73-.33 1.43.18 1.15 1.3l-2.72 12.81c-.19.91-.74 1.13-1.5.71L12.6 16.3l-1.99 1.93c-.23.23-.42.42-.83.42z'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: center;
            z-index: 1002;
        }
        .telegram-btn:hover {
            background: rgba(255,255,255,0.2);
            box-shadow: 0 0 8px rgba(255,255,255,0.5);
        }
    </style>
</head>
<body>
    <div id="white-overlay"></div>
    <div id="logo-container">
        <canvas id="logo-canvas"></canvas>
    </div>
    <div id="cursor-container">
        <canvas id="cursor-canvas"></canvas>
    </div>

    <div id="arterii-license">
        <div>© 2025 ARTERRII. Все права защищены</div>
        <div>Это цифровой арт-музей. Только для просмотра</div>
        <div>Копирование и использование запрещено</div>
    </div>

    <span class="telegram-btn" id="telegram-link" title="Telegram"></span>
    <span class="fullscreen-btn" id="fullscreen-toggle">↘</span>

    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/loaders/FontLoader.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.132.2/examples/js/geometries/TextGeometry.js"></script>
    <script>
        // Инициализация сцены, камеры и рендерера для логотипа
        const scene = new THREE.Scene();
        const camera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
        const renderer = new THREE.WebGLRenderer({ 
            antialias: true,
            canvas: document.getElementById('logo-canvas'),
            alpha: true
        });
        renderer.setSize(210, 210);
        renderer.setPixelRatio(window.devicePixelRatio);

        // Настройка камеры
        camera.position.z = 8;

        // Цвета шариков (спектр радуги)
        const colors = [
            '#7F00FF', '#0000FF', '#00BFFF', 
            '#00FF80', '#FFFF00', '#FF6000', '#FF0000'
        ];

        // Переменные для хранения объектов
        let centerBall;
        let logoGroup;
        let smallBalls = [];
        let textMaterial;
        let isCursorActive = false;
        let whiteOverlayActive = false;
        let touchTimer = null;
        const touchDuration = 500;

        // 1. Загрузка шрифта для букв
        const fontLoader = new THREE.FontLoader();
        fontLoader.load('https://cdn.jsdelivr.net/npm/three@0.132.2/examples/fonts/helvetiker_regular.typeface.json', (font) => {
            createLogo(font);
        });

        function createLogo(font) {
            // Параметры букв
            const textHeight = 0.5;
            const textSize = 0.2;
            const textParams = {
                font: font,
                size: textSize,
                height: textHeight,
                curveSegments: 12,
                bevelEnabled: false
            };

            // Материал для букв
            textMaterial = new THREE.MeshPhongMaterial({
                color: 0xffffff,
                emissive: 0xffffff,
                emissiveIntensity: 1,
                shininess: 100,
                transparent: true,
                opacity: 0.9
            });

            // Создание букв "A" и "T"
            function create3DText(char, isUpsideDown = false) {
                const textGeo = new THREE.TextGeometry(char, textParams);
                textGeo.computeBoundingBox();
                const textMesh = new THREE.Mesh(textGeo, textMaterial);
                
                if (isUpsideDown) {
                    textMesh.rotation.z = Math.PI;
                }
                
                return textMesh;
            }

            // Сборка логотипа
            const radius = 2;
            logoGroup = new THREE.Group();

            const letters = [
                { char: 'A', angle: 0 },
                { char: 'T', angle: Math.PI / 2 },
                { char: 'A', angle: Math.PI, isUpsideDown: true },
                { char: 'T', angle: Math.PI * 1.5, isUpsideDown: true }
            ];

            letters.forEach((letter) => {
                const text = create3DText(letter.char, letter.isUpsideDown);
                text.position.set(
                    Math.cos(letter.angle) * radius,
                    Math.sin(letter.angle) * radius,
                    0
                );
                text.rotation.z = letter.angle + Math.PI / 2;
                logoGroup.add(text);
            });

            scene.add(logoGroup);

            // 2. Центральный шар
            const centerBallGeometry = new THREE.SphereGeometry(0.7, 32, 32);
            const centerBallMaterial = new THREE.MeshPhongMaterial({
                color: 0xffffff,
                emissive: 0xffffff,
                emissiveIntensity: 2,
                shininess: 100,
                transparent: true,
                opacity: 0.95
            });
            centerBall = new THREE.Mesh(centerBallGeometry, centerBallMaterial);
            scene.add(centerBall);

            // 3. Маленькие шарики
            const ballGeometry = new THREE.SphereGeometry(0.15, 16, 16);
            
            colors.forEach((color, i) => {
                const ballMaterial = new THREE.MeshPhongMaterial({
                    color: new THREE.Color(color),
                    emissive: new THREE.Color(color),
                    emissiveIntensity: 1.5,
                    shininess: 50,
                    transparent: true,
                    opacity: 0.9
                });
                const ball = new THREE.Mesh(ballGeometry, ballMaterial);
                
                const angle = (i / colors.length) * Math.PI * 2;
                const distance = 4.5;
                ball.position.set(
                    Math.cos(angle) * distance,
                    Math.sin(angle) * distance,
                    0
                );
                
                smallBalls.push(ball);
                scene.add(ball);
            });

            // Освещение
            const ambientLight = new THREE.AmbientLight(0x404040);
            scene.add(ambientLight);

            const pointLight = new THREE.PointLight(0xffffff, 2, 10);
            pointLight.position.set(0, 0, 2);
            scene.add(pointLight);

            // Настройка курсора
            const cursorRenderer = new THREE.WebGLRenderer({ 
                antialias: true,
                canvas: document.getElementById('cursor-canvas'),
                alpha: true
            });
            cursorRenderer.setSize(40, 40);
            cursorRenderer.setPixelRatio(window.devicePixelRatio);

            const cursorScene = new THREE.Scene();
            const cursorCamera = new THREE.PerspectiveCamera(75, 1, 0.1, 1000);
            cursorCamera.position.z = 8;

            // Функция для переключения белого фона
            function toggleWhiteOverlay() {
                whiteOverlayActive = !whiteOverlayActive;
                document.getElementById('white-overlay').style.display = whiteOverlayActive ? 'block' : 'none';
            }

            // Обработчики событий мыши
            document.addEventListener('mousemove', (e) => {
                if (!isCursorActive) {
                    scene.remove(centerBall);
                    isCursorActive = true;
                    document.getElementById('cursor-container').style.display = 'block';
                }
                
                document.getElementById('cursor-container').style.left = e.clientX + 'px';
                document.getElementById('cursor-container').style.top = e.clientY + 'px';
                
                cursorScene.children = [];
                cursorScene.add(centerBall);
                cursorRenderer.render(cursorScene, cursorCamera);
            });

            document.addEventListener('mouseout', () => {
                if (isCursorActive) {
                    cursorScene.remove(centerBall);
                    scene.add(centerBall);
                    isCursorActive = false;
                    document.getElementById('cursor-container').style.display = 'none';
                }
            });

            // Блокировка контекстного меню
            document.addEventListener('contextmenu', (e) => {
                e.preventDefault();
                toggleWhiteOverlay();
            });

            // Обработчики для сенсорных устройств
            document.addEventListener('touchstart', (e) => {
                if (!isCursorActive) {
                    scene.remove(centerBall);
                    isCursorActive = true;
                    document.getElementById('cursor-container').style.display = 'block';
                }
                
                touchTimer = setTimeout(() => {
                    toggleWhiteOverlay();
                }, touchDuration);
                
                const touch = e.touches[0];
                document.getElementById('cursor-container').style.left = touch.clientX + 'px';
                document.getElementById('cursor-container').style.top = touch.clientY + 'px';
                
                cursorScene.children = [];
                cursorScene.add(centerBall);
                cursorRenderer.render(cursorScene, cursorCamera);
            });

            document.addEventListener('touchmove', (e) => {
                e.preventDefault();
                if (touchTimer) {
                    clearTimeout(touchTimer);
                    touchTimer = null;
                }
                
                const touch = e.touches[0];
                document.getElementById('cursor-container').style.left = touch.clientX + 'px';
                document.getElementById('cursor-container').style.top = touch.clientY + 'px';
                
                cursorScene.children = [];
                cursorScene.add(centerBall);
                cursorRenderer.render(cursorScene, cursorCamera);
            }, { passive: false });

            document.addEventListener('touchend', () => {
                if (isCursorActive) {
                    cursorScene.remove(centerBall);
                    scene.add(centerBall);
                    isCursorActive = false;
                    document.getElementById('cursor-container').style.display = 'none';
                }
                
                if (touchTimer) {
                    clearTimeout(touchTimer);
                    touchTimer = null;
                }
            });

            // Анимация
            function animate() {
                requestAnimationFrame(animate);
                
                logoGroup.rotation.z += 0.005;
                
                if (!isCursorActive) {
                    const pulse = 1 + Math.sin(Date.now() * 0.001) * 0.15;
                    centerBall.scale.setScalar(pulse);
                    centerBall.material.emissiveIntensity = 1 + Math.sin(Date.now() * 0.001) * 1;
                }
                
                textMaterial.emissiveIntensity = 0.8 + Math.sin(Date.now() * 0.0015) * 0.5;
                
                smallBalls.forEach((ball, i) => {
                    const ballPulse = 0.8 + Math.sin(Date.now() * 0.001 + i) * 0.3;
                    ball.scale.setScalar(ballPulse);
                    ball.material.emissiveIntensity = 1 + Math.sin(Date.now() * 0.001 + i * 2) * 0.8;
                    
                    const angle = (i / colors.length) * Math.PI * 2 + Date.now() * 0.0007;
                    const distance = 4.5 + Math.sin(Date.now() * 0.001 + i) * 0.4;
                    ball.position.set(
                        Math.cos(angle) * distance,
                        Math.sin(angle) * distance,
                        0
                    );
                });
                
                renderer.render(scene, camera);
                
                if (isCursorActive) {
                    const pulse = 1 + Math.sin(Date.now() * 0.001) * 0.15;
                    centerBall.scale.setScalar(pulse);
                    centerBall.material.emissiveIntensity = 1 + Math.sin(Date.now() * 0.001) * 1;
                    cursorRenderer.render(cursorScene, cursorCamera);
                }
            }
            
            animate();
        }

        // Функция для переключения полноэкранного режима
        const toggleFullscreen = () => {
            if (!document.fullscreenElement) {
                document.documentElement.requestFullscreen().catch(err => {
                    console.error(`Ошибка при включении полноэкранного режима: ${err.message}`);
                });
            } else {
                if (document.exitFullscreen) {
                    document.exitFullscreen();
                }
            }
        };

        // Обработчик для кнопки Telegram
        document.getElementById('telegram-link').addEventListener('click', () => {
            window.open('https://t.me/arterrii_ru', '_blank');
        });

        // Обработчик изменения полноэкранного режима
        document.addEventListener('fullscreenchange', () => {
            const btn = document.getElementById('fullscreen-toggle');
            if (document.fullscreenElement) {
                btn.textContent = '↖️';
                document.body.style.background = '#000';
            } else {
                btn.textContent = '↘️';
            }
        });

        document.getElementById('fullscreen-toggle').addEventListener('click', toggleFullscreen);

        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape' && document.fullscreenElement) {
                e.preventDefault();
            }
        });

        // Поддержка префиксов браузеров
        document.addEventListener('webkitfullscreenchange', () => {
            const btn = document.getElementById('fullscreen-toggle');
            if (document.webkitFullscreenElement) {
                btn.textContent = '↖️';
            } else {
                btn.textContent = '↘️';
            }
        });

        document.addEventListener('mozfullscreenchange', () => {
            const btn = document.getElementById('fullscreen-toggle');
            if (document.mozFullScreenElement) {
                btn.textContent = '↖️';
            } else {
                btn.textContent = '↘️';
            }
        });

        document.addEventListener('msfullscreenchange', () => {
            const btn = document.getElementById('fullscreen-toggle');
            if (document.msFullscreenElement) {
                btn.textContent = '↖️';
            } else {
                btn.textContent = '↘️';
            }
        });
    </script>
</body>
</html>
